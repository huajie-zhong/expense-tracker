{%extends "header.html"%} {%block content%}
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<body>
  <div id="header-container"></div>
  <div class="container">
    <form id="expenseForm" enctype="multipart/form-data">
      <label for="expenseType">Expense Type:</label>
      <select id="expenseType" name="expenseType">
        <option value="travel">Travel</option>
        <option value="accommodation">Accommodation</option>
        <option value="meals">Meals</option>
        <option value="more options">More Options</option>
        <!-- Add more options as needed -->
      </select>

      <div id="newOption">
      <label for="newOption">New Option:</label>
      <input type="text" id="newOptionValue" placeholder="Enter new option">
      <button type="button" id="addOptionButton" onclick="addOption()">Add Option</button>
      </div>

      <label for="amount">Amount:</label>
      <input
        type="number"
        id="amount"
        name="amount"
        placeholder="Enter amount"
        required
      />

      <label for="receipt">Upload Receipt:</label>
      <input type="file" id="receipt" name="receipt" />

      <button type="button" onclick="submitExpense()">Submit</button>
    </form>
  </div>
  <!-- Display Expense Reports -->
  <div id="report">
    <h3>Total Amount:</h3>
    <p id="totalAmount">0</p>

    <h3>Expense Categories:</h3>
    <canvas id="expenseChart" width="400" height="400"></canvas>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="{{url_for('static', filename='script.js')}}"></script>
  {% if current_user.is_authenticated %}
  <script>
    $(document).ready(updateExpense());
  </script>
  {% endif %}
  <script>

    // TODO debug
    // Get the select element
    var select = document.getElementById("expenseType");

    // Function to add an option
    function addOption() {
      // Get the input value
      var option = document.getElementById("newOptionValue").value;

      if (option === "") {
        alert("Please enter a value");
        return;
      }

      // Create new option element
      var opt = document.createElement("option");
      opt.value = option;
      opt.innerHTML = option;

      // Add the option to the select
      select.appendChild(opt);

      // Clear the input field
      document.getElementById("newOptionValue").value = "";
    }

    // Attach the function to a button
    document.getElementById("addOptionButton").addEventListener("click", addOption);

    // Hide the input fields and button initially
    document.getElementById("newOption").style.display = "none";

    // Show the input fields and button when "more options" is selected
    select.addEventListener("change", function() {
      if (this.value === "more options") {
        document.getElementById("newOption").style.display = "block";
      } else {
        document.getElementById("newOption").style.display = "none";
      }
    });  
    </script>
</body>
{%endblock%}
